# Loading-and-Exporting-Data-using-MySQL
This process allows you to extract data from a webpage, load it into a MySQL database, query the data, dump the data to a file, and then load the dumped data into a new database.

## Video Demo
[![Loading and Exporting Data using MySQL](https://img.youtube.com/vi/trBO0Qpe13k/0.jpg)](https://youtu.be/trBO0Qpe13k "Loading and Exporting Data using MySQL")

## Generate CSV file
The csv file was extracted from [science.nasa.gov/eclipses/future-eclipses](https://science.nasa.gov/eclipses/future-eclipses) and generated by `scrapy` python module.

## Load the data into MySQL
This process allows you to load data from a CSV file into a MySQL database. It’s important to note that the LOAD DATA LOCAL INFILE command can pose a security risk if you’re loading data from untrusted or unverified sources. Always make sure your data is from a trusted source and is properly formatted to prevent SQL injection attacks or other security issues.

Run mysql and login as root
```ps
mysql -u root -p --local-infile
```
Check local_infile flag configuration

```sql
show global variables like 'local_infile';
```
If set to OFF, set the flag ON. Check again just to be sure.

```sql
set global local_infile=ON;
```

Create `Eclipses` database were the csv data will be stored

```sql
CREATE DATABASE Eclipses;
SHOW DATABASES;
USE Eclipses;
SHOW FULL TABLES;
```

Create table `solar_eclipses` were the data will be stored

```sql
CREATE TABLE IF NOT EXISTS solar_eclipses (
    EclipseID INT NOT NULL AUTO_INCREMENT,
    EclipseDate DATE NOT NULL,
    SolarEclipseType VARCHAR(255) NOT NULL,
    GeographicRegionofVisibility TEXT NOT NULL,
    PRIMARY KEY (EclipseID)
) ENGINE = InnoDB;
```
Load data from the CSV file `Solar Eclipses.csv` into `solar_eclipses` table

```sql
LOAD DATA LOCAL INFILE 'Solar Eclipses.csv' 
INTO TABLE solar_eclipses
FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
LINES TERMINATED BY '\r\n'
IGNORE 1 LINES
(@EclipseID, @EclipseDate, @SolarEclipseType, @GeographicRegionofVisibility) 
SET EclipseDate=@EclipseDate, SolarEclipseType=@SolarEclipseType, GeographicRegionofVisibility=@GeographicRegionofVisibility;
```
Once the data is stored deactivate local infile and verify the flag is OFF

```sql
set global local_infile=OFF;
show global variables like 'local_infile';
```

## Querry data from MySQL

Fetch data from `solar_eclipses` table

```sql
SELECT 
    EclipseDate,
    SolarEclipseType,
    GeographicRegionofVisibility
FROM solar_eclipses;
```

Wondering when the next solar eclipse will be?
```sql
SELECT 
    EclipseDate,
    SolarEclipseType,
    GeographicRegionofVisibility
FROM solar_eclipses
WHERE DATEDIFF(EclipseDate, CURDATE()) <= 365/2;
```

## Dump data from MySQL
Use `mysqldump` command to dump the data to `eclipsesdb.sql` file

```ps
mysqldump -u root -p eclipses --result-file=sql_quarries/eclipsesdb.sql
```

## Loading data from mysqldump
The process of loading data after using `mysqldump` starts by creating the new `EclipseCopy` database and ends after running the `eclipsesdb.sql` file generated beforehand. Make sure you use the `EclipseCopy` database before running any query.

Create a new database where the data will be stored or add the next query to the mysqldumped file
```sql
CREATE DATABASE EclipsesCopy;
SHOW DATABASES;
USE EclipsesCopy;
SHOW FULL TABLES;
```

Query the mysqldumped file `eclipsesdb.sql`, if succesful you should have a working copy of `Eclipses` database.

```sql
--
-- Table structure for table `solar_eclipses`
--

DROP TABLE IF EXISTS `solar_eclipses`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `solar_eclipses` (
  `EclipseID` int NOT NULL AUTO_INCREMENT,
  `EclipseDate` date NOT NULL,

  [...]

/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2024-04-18 17:32:59
```

You can check the data running a simple querry.

```sql
SELECT * FROM solar_eclipses;
```